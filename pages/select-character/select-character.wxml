<!-- è§’è‰²é€‰æ‹©é¡µ - ä¸¥æ ¼æŒ‰ç…§V7åŸå‹è®¾è®¡ -->
<view class="character-container">
  <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
  <view class="header">
    <view class="header-title">é€‰æ‹©é™ªä¼´ä¼™ä¼´</view>
  </view>

  <!-- ä¸»å†…å®¹åŒºåŸŸ -->
  <view class="content">
    <!-- ç­›é€‰åŒºåŸŸ - æŒ‰ç…§V7è®¾è®¡ -->
    <view class="filter-area">
      <view 
        class="filter-tag {{currentFilter === item.key ? 'active' : ''}}"
        wx:for="{{filterTags}}" 
        wx:key="key"
        bindtap="onFilterChange"
        data-filter="{{item.key}}"
      >
        {{item.name}}
      </view>
    </view>
    
    <!-- è§’è‰²ç½‘æ ¼ - æŒ‰ç…§V7è®¾è®¡ -->
    <scroll-view class="character-scroll" scroll-y="true">
      <view class="role-grid">
        <view 
          class="card role-card"
          wx:for="{{filteredCharacters}}" 
          wx:key="id"
          bindtap="openCharacterEditor"
          data-character="{{item}}"
        >
          <!-- è§’è‰²å¤´åƒ - åœ†è§’çŸ©å½¢ -->
          <view class="role-avatar">
            <view class="role-icon">ğŸ¤–</view>
          </view>
          
          <!-- è§’è‰²ä¿¡æ¯ -->
          <view class="role-title">{{item.name}}</view>
          <view class="role-desc">{{item.description}}</view>

          <!-- ç¼–è¾‘æ ‡ç­¾ -->
          <view class="edit-hint">ç‚¹å‡»è°ƒæ•´ä¸ªæ€§</view>
          
          <!-- è§£é”çŠ¶æ€æŒ‡ç¤ºå™¨ -->
          <view class="unlock-indicator" wx:if="{{!item.unlocked}}">
            <view class="lock-icon">ğŸ”’</view>
          </view>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- è§’è‰²ä¸ªæ€§ç¼–è¾‘å¼¹çª— -->
  <view class="character-modal {{showEditor ? 'show' : ''}}" bindtap="closeEditor">
    <view class="modal-content" catchtap="stopPropagation">
      <view class="modal-header">
        <view class="modal-avatar"><view class="modal-icon-emoji">{{editingCharacter.icon || 'ğŸ¤–'}}</view></view>
        <view class="modal-close" bindtap="closeEditor"><view class="close-emoji">âœ•</view></view>
      </view>
      <view class="modal-body">
        <view class="modal-name">{{editingCharacter.name}}</view>
        <view class="form-row">
          <view class="form-label">æ€§åˆ«</view>
          <picker mode="selector" range="{{genderOptions}}" value="{{genderIndex}}" bindchange="onGenderChange">
            <view class="picker-value">{{genderOptions[genderIndex]}}</view>
          </picker>
        </view>
        <view class="form-row">
          <view class="form-label">æ€§æ ¼/è¯´è¯æ–¹å¼</view>
          <picker mode="selector" range="{{styleOptions}}" value="{{styleIndex}}" bindchange="onStyleChange">
            <view class="picker-value">{{styleOptions[styleIndex]}}</view>
          </picker>
        </view>
        <view class="form-row">
          <view class="form-label">èº«ä»½</view>
          <picker mode="selector" range="{{identityOptions}}" value="{{identityIndex}}" bindchange="onIdentityChange">
            <view class="picker-value">{{identityOptions[identityIndex]}}</view>
          </picker>
        </view>
        <view class="form-row">
          <view class="form-label">è®¾å®šï¼ˆä¸ç”¨æˆ·å…³ç³»ï¼‰</view>
          <picker mode="selector" range="{{relationshipOptions}}" value="{{relationshipIndex}}" bindchange="onRelationshipChange">
            <view class="picker-value">{{relationshipOptions[relationshipIndex]}}</view>
          </picker>
        </view>
      </view>
      <view class="modal-footer">
        <view class="modal-btn cancel" bindtap="closeEditor">å–æ¶ˆ</view>
        <view class="modal-btn confirm" bindtap="saveCharacterProfile">ä¿å­˜</view>
      </view>
    </view>
  </view>
  <!-- åº•éƒ¨æ ‡ç­¾æ  - V7åŸå‹ï¼šä¸‰ä¸ªä¸»å¯¼èˆªï¼ˆå¯¹è¯/è§’è‰²/è®¾ç½®ï¼‰ -->
  <view class="bottom-tab-bar">
    <view class="tab-item" bindtap="navigateToHome">
      <view class="tab-icon">ğŸ’¬</view>
      <view class="tab-text">å¯¹è¯</view>
    </view>
    <view class="tab-item active">
      <view class="tab-icon">ğŸ¤–</view>
      <view class="tab-text">è§’è‰²</view>
    </view>
    <view class="tab-item" bindtap="navigateToSettings">
      <view class="tab-icon">âš™ï¸</view>
      <view class="tab-text">è®¾ç½®</view>
    </view>
  </view>
  
  <!-- è§’è‰²è¯¦æƒ…å¼¹çª— -->
  <view class="character-modal {{showModal ? 'show' : ''}}" bindtap="hideModal">
    <view class="modal-content" catchtap="stopPropagation">
      <view class="modal-header">
        <view class="modal-avatar">
          <view class="modal-icon-emoji">ğŸ¤–</view>
        </view>
        <view class="modal-close" bindtap="hideModal">
          <view class="close-emoji">âœ•</view>
        </view>
      </view>
      
      <view class="modal-body">
        <view class="modal-name">{{selectedCharacter.name}}</view>
        <view class="modal-desc">{{selectedCharacter.description}}</view>
        <!-- æ¨¡å‹ä¿¡æ¯æ˜¾ç¤º -->
        <view class="modal-model-info">
          <view class="model-tag">{{selectedCharacter.modelDesc}}</view>
        </view>
        <view class="modal-detail">{{selectedCharacter.detail}}</view>
      </view>
      
      <view class="modal-footer">
        <view class="modal-btn cancel" bindtap="hideModal">å–æ¶ˆ</view>
        <view 
          class="modal-btn confirm {{selectedCharacter.unlocked ? '' : 'locked'}}"
          bindtap="confirmSelect"
        >
          {{selectedCharacter.unlocked ? 'å¼€å§‹å¯¹è¯' : 'è§‚çœ‹å¹¿å‘Šè§£é”'}}
        </view>
      </view>
    </view>
  </view>
</view>