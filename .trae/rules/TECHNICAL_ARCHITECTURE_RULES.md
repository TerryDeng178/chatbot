# AI 社交群聊小程序 - 技术架构与开发规划 v2.0 (Taro 多平台版)

## 第一章：技术选型 (Tech Stack)

**核心思想**：采用业界成熟、高效、高性价比的“Taro多平台框架 + 全云开发”方案，实现“一次开发，多端运行”的战略目标，同时借助云开发的弹性能力，完美支撑项目从0到1，再到100万用户的平滑增长。

### 1. 前端框架 (Frontend Framework)
*   **选型**: **Taro 框架 (React 版本)**
*   **理由**:
    *   **多端覆盖**: 一套代码，可直接编译成微信小程序、H5、App (React Native) 等多个版本，极大提升开发效率，降低维护成本，为产品未来的渠道拓展奠定坚实基础。
    *   **主流技术栈**: 使用业界广泛流行的 React 语法，生态成熟，组件丰富，开发体验优秀。
    *   **性能优越**: Taro 在编译时会最大程度地将代码转换为目标平台的原生语法，确保在各端都能获得接近原生的性能体验。

### 2. UI 组件库 (UI Component Library)
*   **选型**: **TDesign Tona**
*   **理由**:
    *   **官方出品，设计规范**: 腾讯官方的企业级设计体系，提供美观、一致、开箱即用的高质量组件。
    *   **跨平台兼容**: 专为Taro框架打造，确保在不同终端上表现一致。
    *   **主题定制**: 支持灵活的样式定制，满足我们产品的个性化视觉需求。

### 3. 后端服务 (Backend Service)
*   **选型**: **腾讯云开发 (Tencent Cloud Base, TCB)**
*   **理由**:
    *   **一站式解决**: TCB 提供了集云函数、云数据库、云存储于一体的 Serverless (无服务器)解决方案，我们无需关心服务器购买、配置、运维等任何底层杂事。
    *   **与 Taro 无缝集成**: Taro 官方提供了 `@tarojs/cloud` 插件，可以通过 `Taro.cloud` API 在前端直接、安全地调用所有云开发资源，开发体验如丝般顺滑。
    *   **弹性伸缩与成本效益**: 完全按量计费，项目初期用户少时，成本极低；当用户量暴增时，后台能自动扩容，从容应对。

### 4. 核心服务拆解 (Core Service Breakdown)
*   **计算层 - 云函数 (Cloud Functions)**: 我们所有后端业务逻辑的载体。
*   **数据层 - 云数据库 (Cloud Database)**: 一个高性能的 NoSQL 数据库，用于存放所有持久化数据。
*   **文件层 - 云存储 (Cloud Storage)**: 用于存放用户或 AI 生成的文件，如 AI 角色的语音。

### 5. 人工智能服务 (AI Services)
*   **选型**: **外部商业化 API** (保持不变)
*   **理由**: 站在巨人的肩膀上，直接调用业界最顶尖、最成熟的 AI 服务，能让我们在最短时间内，获得最强大的 AI 能力。

---

## 第二步：数据库设计 (Database Schema)

数据库设计与前端框架无关，作为应用的“数据仓库”，其结构保持不变，继续使用 TCB 提供的“云数据库”。

### 1. 核心数据表 (Core Tables)
(此部分设计保持不变，具体内容省略)

### 2. 核心设计策略：冷热数据分离
(此部分设计保持不变，具体内容省略)

---

## 第三步：核心云函数/API 设计 (Core Cloud Function/API Design)

云函数/API 是连接前端界面和后端数据的“大脑”与“中枢”。我们将通过 `Taro.cloud.callFunction` 来调用云函数，执行所有核心业务逻辑。

### 1. 核心 API 列表 (基于云函数)

| 云函数名称 (name)       | 核心职责                                                     | 调用方式 (示例)                                     |
| ----------------------- | ------------------------------------------------------------ | --------------------------------------------------- |
| `user-login`            | 用户登录与注册，获取或创建用户在数据库中的记录。             | `Taro.cloud.callFunction({ name: 'user-login' })`     |
| `user-getWelcomePackage`| 为新用户执行“开场高潮”策略，创建专属镜像欢迎群及初始消息。     | `Taro.cloud.callFunction({ name: 'user-getWelcomePackage' })` |
| `chat-sendMessage`      | 用户发送消息，存入数据库，并调用 AI 模型获取角色回复。         | `Taro.cloud.callFunction({ name: 'chat-sendMessage', data: { ... } })` |
| `chat-getMessages`      | 分页加载指定群组的聊天记录。                                 | `Taro.cloud.callFunction({ name: 'chat-getMessages', data: { ... } })` |
| `chat-listGroups`       | 获取当前用户加入的所有群组列表。                             | `Taro.cloud.callFunction({ name: 'chat-listGroups' })` |
| `user-reportUnlock`     | 用户成功观看广告后，上报解锁的角色ID。                       | `Taro.cloud.callFunction({ name: 'user-reportUnlock', data: { ... } })` |

---

## 第四步：分阶段开发路线图 (Phased Development Roadmap)

我们将采用“敏捷开发”模式，通过分阶段迭代，确保项目“小步快跑”，快速验证，风险可控。

### **第一阶段：MVP - 核心对话体验闭环 (预计 3-4 周)**

*   **核心目标**: 基于 Taro 框架跑通核心玩法，验证用户对“AI 群聊”的兴趣。
*   **要开发的功能**:
    *   **Taro 项目初始化**: 搭建基于 Taro/React 的项目结构。
    *   **用户登录**: 实现基于 `Taro.login` 和 `user-login` 云函数的登录流程。
    *   **页面开发**: 使用 Taro 创建 `Home`、`Chat`、`SelectCharacter` 等核心页面。
    *   **开场高潮**: 调用 `user-getWelcomePackage` 云函数，自动创建镜像欢迎群。
    *   **核心聊天**: 实现基于 Taro 的聊天界面，支持文本消息的发送和接收。
    *   **AI 对话**: 调用 `chat-sendMessage` 云函数，后端成功调用大语言模型，AI 角色能进行有效回复。
    *   **情感化体验 V1**: AI 的回复能自动附带 Emoji，提升生动性。
    *   包含 2-3 个精心设计的官方免费 AI 角色。
*   **交付成果**: 一个核心体验完整、流畅的**微信小程序版**，作为首个发布平台进行内部测试。

### **第二阶段：商业化与社交扩展 (MVP 之后 2-3 周)**

*   **核心目标**: 验证广告变现模式，并增加基础的社交裂变能力。
*   **要开发的功能**:
    *   **广告解锁**: 集成 Taro 的广告 API (`Taro.createRewardedVideoAd`)，调用 `user-reportUnlock` 云函数，实现观看广告解锁 AI 角色。
    *   推出第一批更高质量的、可通过广告解锁的 AI 角色。
    *   **基础社交**: 允许用户创建普通群聊，并邀请好友或已拥有的 AI 角色加入。
*   **交付成果**: 一个具备核心付费功能和基础社交玩法的**正式上线版本 V1.0 (多端发布)**，可同时发布到微信小程序和 H5。

### **第三阶段：UGC 与生态深化 (第二阶段之后 4-6 周)**

*   **核心目标**: 开放用户创造力，构建社区生态，提升长期留存和产品护城河。
*   **要开发的功能**:
    *   **UGC 创建 AI**: 提供编辑器页面，让用户可以自定义创建自己的 AI 角色。
    *   **AI 角色市场**: 建立“发现”页面，展示和分享用户创建的优秀 AI。
    *   **情感化体验 V2**: 集成 **TTS/ASR**，实现语音消息的发送和 AI 的语音回复。
*   **交付成果**: 一个具备 UGC 生态雏形、玩法更丰富、社区氛围更浓厚的**成熟版本 V2.0**。

---

**一句话总结：我们将在 Taro 这个“跨平台地基”上，用腾讯云开发这套“一体化施工工具”，调用外部 AI 服务这个“超级大脑”，来搭建我们的“AI 社交大楼”，并能轻松地将它“复制”到不同应用商店中。**