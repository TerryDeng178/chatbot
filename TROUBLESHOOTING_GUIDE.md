# 云函数故障排除指南

## 当前问题
`FunctionName parameter could not be found` 错误

## 问题分析
这个错误通常由以下原因引起：
1. 云函数未部署到云端
2. 云函数名称不匹配
3. 云开发环境配置错误
4. 云函数代码有语法错误

## 详细解决步骤

### 第一步：检查云开发环境
1. 打开微信开发者工具
2. 点击顶部菜单栏的"云开发"
3. 确认环境ID：`cloud3-8gtjhkakd53d4fdc`
4. 检查环境状态是否正常

### 第二步：检查云函数部署状态
1. 在云开发控制台中，点击"云函数"
2. 查看是否有以下云函数：
   - `user-report-presence`
   - `chat-list-groups`
   - `chat-create-group`
   - `chat-send-message`
   - `chat-get-messages`
   - `chat-ai-greet`
   - `user-login`
   - `user-update-profile`
   - `user-reset-quota`
   - `user-report-unlock`
   - `user-get-welcome-package`
   - `system-status`
   - `init-database`

### 第三步：重新部署云函数
#### 方法1：批量部署（推荐）
1. 在微信开发者工具中，右键点击 `src/backend/` 目录
2. 选择"上传并部署：云端安装依赖"
3. 等待部署完成

#### 方法2：逐个部署
如果批量部署失败，请逐个部署：
1. 右键点击 `src/backend/user-report-presence/` 目录
2. 选择"上传并部署：云端安装依赖"
3. 重复上述步骤，部署其他云函数

### 第四步：验证部署
1. 部署完成后，在云开发控制台检查云函数状态
2. 确认所有云函数状态为"正常"
3. 检查云函数版本号是否更新

### 第五步：测试功能
1. 重新编译小程序
2. 检查控制台是否还有错误
3. 测试群聊列表加载功能
4. 测试在线状态上报功能

## 常见错误及解决方案

### 错误1：部署权限不足
**现象**：部署时提示权限不足
**解决**：
- 确认微信开发者工具已登录正确的微信账号
- 确认该账号有云开发权限
- 尝试重新登录微信开发者工具

### 错误2：云函数部署失败
**现象**：部署过程中出现错误
**解决**：
- 检查网络连接
- 检查云开发环境是否可用
- 查看云开发控制台错误日志
- 尝试重新部署

### 错误3：部署后仍然报错
**现象**：云函数已部署，但前端仍然报错
**解决**：
- 清除微信开发者工具缓存
- 重新编译项目
- 检查云函数名称是否与代码中调用的一致
- 确认云函数环境配置正确

### 错误4：云函数运行异常
**现象**：云函数部署成功但运行出错
**解决**：
- 查看云函数运行日志
- 检查云函数代码语法
- 确认数据库集合是否存在
- 检查云函数权限配置

## 预防措施
1. 每次修改云函数代码后，及时重新部署
2. 保持云函数依赖版本一致
3. 定期检查云函数运行状态
4. 保持微信开发者工具版本更新

## 联系支持
如果问题仍然存在：
1. 查看云开发控制台详细错误日志
2. 联系腾讯云技术支持
3. 提供以下信息：
   - 错误截图
   - 云函数部署状态截图
   - 环境配置信息
   - 详细的错误描述

## 快速检查清单
- [ ] 云开发环境ID正确
- [ ] 云函数已部署到云端
- [ ] 云函数状态为"正常"
- [ ] 云函数名称与代码调用一致
- [ ] 微信开发者工具已重新编译
- [ ] 控制台错误已清除
